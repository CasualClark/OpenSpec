# SSL/TLS Configuration for Task MCP HTTP Server
# TLS 1.3 only with modern cipher suites

# SSL/TLS protocols
ssl_protocols TLSv1.3;
ssl_prefer_server_ciphers on;

# Modern cipher suites for TLS 1.3
ssl_ciphers TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256;

# SSL session settings
ssl_session_timeout 1d;
ssl_session_cache shared:SSL:50m;
ssl_session_tickets off;

# OCSP Stapling
ssl_stapling on;
ssl_stapling_verify on;

# Certificate verification
ssl_verify_depth 2;

# HSTS (HTTP Strict Transport Security)
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# SSL certificate paths (update these paths based on your certificate location)
ssl_certificate /etc/nginx/ssl/task-mcp-server.crt;
ssl_certificate_key /etc/nginx/ssl/task-mcp-server.key;

# DH parameters (for backward compatibility if needed)
# ssl_dhparam /etc/nginx/ssl/dhparam.pem;

# SSL stapling file
ssl_trusted_certificate /etc/nginx/ssl/task-mcp-chain.crt;

# SSL configuration for development (self-signed certificates)
# Uncomment for development environment
# ssl_certificate /etc/nginx/ssl/dev-task-mcp.crt;
# ssl_certificate_key /etc/nginx/ssl/dev-task-mcp.key;
# ssl_verify_client off;